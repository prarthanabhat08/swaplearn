<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile – SwapLearn</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            font-family: "Poppins", sans-serif;
            background: #f4f6fa;
        }

        .profile-card {
            border-radius: 18px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.06);
            padding: 35px;
            background: white;
        }

        .avatar {
            width: 110px;
            height: 110px;
            border-radius: 50%;
            background: #4f46e5;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 42px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .skill-badge {
            margin: 6px;
            padding: 8px 12px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 500;
            display: inline-block;
        }

        .badge-need {
            background: #e0e7ff;
            color: #4338ca;
        }

        .badge-teach {
            background: #d1fae5;
            color: #065f46;
        }
    </style>
</head>

<body>


    <!-- NAV BAR -->
    <nav class="navbar navbar-expand-lg bg-white shadow-sm">
        <div class="container">
            <a class="navbar-brand fw-bold" href="/">SwapLearn</a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navMain">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navMain">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="discover.html">Discover</a></li>
                    <li class="nav-item"><a class="nav-link" href="match.html">Matches</a></li>
                    <li class="nav-item"><a class="nav-link active fw-bold" href="profile.html">Profile</a></li>
                </ul>
            </div>
        </div>
    </nav>


    <!-- PROFILE CONTENT -->
    <div class="container mt-5">

        <div class="profile-card mx-auto" style="max-width: 650px;">
            
            <div class="text-center">
                <div class="avatar" id="avatarCircle">U</div>
                <h2 id="userName" class="fw-bold mb-1">User Name</h2>
                <p class="text-muted mb-2">Skill Swap Learner</p>

                <div class="badge bg-primary px-3 py-2">
                    Credits: <span id="userCredits">0</span>
                </div>
            </div>

            <hr class="my-4">

            <!-- Skills Need -->
            <h4>Skills You Need</h4>
            <div id="needSkills" class="mb-4">
                <p class="text-muted">Loading...</p>
            </div>

            <!-- Skills Teach -->
            <h4 class="mt-4">Skills You Can Teach</h4>
            <div id="teachSkills">
                <p class="text-muted">Loading...</p>
            </div>

        </div>
    </div>


    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- JS Logic for Profile -->
    <script>

        const CURRENT_USER_ID = 1;   // for now we show Rahul’s profile

        // 1️⃣ Load User Info
        fetch("http://localhost:5000/api/users")
            .then(res => res.json())
            .then(users => {
                const user = users.find(u => u.user_id === CURRENT_USER_ID);

                if (user) {
                    document.getElementById("userName").textContent = user.username;
                    document.getElementById("userCredits").textContent = user.credits;

                    // Avatar Initial
                    document.getElementById("avatarCircle").textContent = user.username[0].toUpperCase();
                }
            });


        // 2️⃣ Load Skills User Needs
        fetch("http://localhost:5000/api/discover/need")
            .then(res => res.json())
            .then(list => {
                const needDiv = document.getElementById("needSkills");
                needDiv.innerHTML = ""; 

                const userNeeds = list.filter(item => item.username === "Rahul");

                if (userNeeds.length === 0) {
                    needDiv.innerHTML = `<p class="text-muted">No skills added yet.</p>`;
                } else {
                    userNeeds.forEach(item => {
                        needDiv.innerHTML += `<span class="skill-badge badge-need">${item.skill_name}</span>`;
                    });
                }
            });


        // 3️⃣ Load Skills User Teaches
        fetch("http://localhost:5000/api/discover/teach")
            .then(res => res.json())
            .then(list => {
                const teachDiv = document.getElementById("teachSkills");
                teachDiv.innerHTML = "";

                const userTeach = list.filter(item => item.username === "Rahul");

                if (userTeach.length === 0) {
                    teachDiv.innerHTML = `<p class="text-muted">No taught skills added yet.</p>`;
                } else {
                    userTeach.forEach(item => {
                        teachDiv.innerHTML += `<span class="skill-badge badge-teach">${item.skill_name}</span>`;
                    });
                }
            });

    </script>

</body>

</html>
